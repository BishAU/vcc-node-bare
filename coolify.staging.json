{
  "name": "vcc-abs-staging",
  "type": "docker",
  "dockerfile": "./Dockerfile",
  "ports": ["3000:3000"],
  "branch": "security-fixes",
  "isStaticBuild": false,
  "preDeployCommands": [
    "npx prisma generate",
    "npx prisma migrate deploy"
  ],
  "env": {
    "NODE_ENV": "staging",
    "VITE_API_BASE_URL": "https://vcc.myinvoices.today/api",
    "DATABASE_URL": "${DATABASE_URL}",
    "DIRECT_URL": "${DIRECT_URL}",
    "STRIPE_SECRET_KEY": "${STRIPE_SECRET_KEY}",
    "XERO_CLIENT_ID": "${XERO_CLIENT_ID}",
    "XERO_CLIENT_SECRET": "${XERO_CLIENT_SECRET}",
    "ABS_API_KEY": "${ABS_API_KEY}",
    "JWT_SECRET": "${JWT_SECRET}",
    "COOKIE_SECRET": "${COOKIE_SECRET}",
    "SENTRY_DSN": "${SENTRY_DSN}"
  },
  "healthCheck": {
    "path": "/api/health",
    "port": 3000
  },
  "pullRequestPreview": {
    "enable": true,
    "hostPrefix": "pr-"
  },
  "deploymentStrategy": {
    "type": "rolling",
    "maxUnavailable": 1
  },
  "resources": {
    "limits": {
      "memory": "512Mi",
      "cpu": "500m"
    },
    "requests": {
      "memory": "256Mi",
      "cpu": "250m"
    }
  }
}
